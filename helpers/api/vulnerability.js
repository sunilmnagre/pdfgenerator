/**
 * 
 * @param {Object} request The Standard ExpressJS request
 * @param {Object} response The Standard ExpressJS response 
 * @param {*} next 
 */
const validateMandatoryParamsOfActions = (request, response, next) => {
  const { actionsToMark } = request.body;
  if (actionsToMark) {
    const params = request.body[actionsToMark];
    const errors = [];
    const attributes = ['reason', 'pluginIds', 'targets', 'portInfo', 'protocol'];
    attributes.forEach((attribute) => {
      if (!params.hasOwnProperty(attribute) || !params[attribute]) {
        errors.push(attribute);
      }
    });
    if (errors.length > 0) {
      return response.status(400).jsend.fail('Missing params - ' + errors.join(' & '));
    }
  }
  next();
};

module.exports = {
  validateMandatoryParamsOfActions
};
